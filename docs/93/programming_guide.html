<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Micro Focus Content Manager SDK 9.3: Programming in Content Manager</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CM_top-banner-logo_layers.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Micro Focus Content Manager SDK 9.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('programming_guide.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Programming in Content Manager </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#programming_in">Introduction</a><ul><li class="level2"><a href="#main_objects">The main objects</a></li>
<li class="level2"><a href="#application_object">Using the Trim Application object</a></li>
<li class="level2"><a href="#database_object">Using the Database object</a></li>
</ul>
</li>
<li class="level1"><a href="#creating_records">Creating and modifying Records</a><ul><li class="level2"><a href="#new_record">Creating new Records</a></li>
<li class="level2"><a href="#access_existing_record">Accessing existing records</a></li>
<li class="level2"><a href="#get_existing_record">Getting a record by record number</a></li>
<li class="level2"><a href="#record_by_uri">Getting a Record by URI</a></li>
</ul>
</li>
<li class="level1"><a href="#reading_record_data">Reading record data</a><ul><li class="level2"><a href="#reading_basic_properties">Basic properties</a></li>
<li class="level2"><a href="#related_objects">Accessing related objects</a></li>
<li class="level2"><a href="#record_Location_info">Accessing record Location information</a></li>
</ul>
</li>
<li class="level1"><a href="#updating_records">Updating records</a><ul><li class="level2"><a href="#modifying_properties">Modifying properties</a></li>
<li class="level2"><a href="#update_methods">Calling update methods</a></li>
<li class="level2"><a href="#updating_properties">Updating properties using SetProperty</a></li>
<li class="level2"><a href="#update_user_defined_fields">User Defined Fields</a></li>
</ul>
</li>
<li class="level1"><a href="#Verifying_and_error_trapping">Verifying and error trapping</a><ul><li class="level2"><a href="#The_Verify_method">The Verify method</a></li>
<li class="level2"><a href="#The_Verified_property">The Verified property</a></li>
<li class="level2"><a href="#Trapping_run-time_errors">Trapping run-time errors</a></li>
<li class="level2"><a href="#Saving_the_record_to_the_database">Saving the record to the database</a></li>
</ul>
</li>
<li class="level1"><a href="#New_records_and_electronic_documents">New records and electronic documents</a><ul><li class="level2"><a href="#Creating_a_record_of_a_given_type">Creating a record of a given type</a></li>
<li class="level2"><a href="#Controlled_and_free_text_titling">Controlled and free text titling</a></li>
<li class="level2"><a href="#Security_Levels_and_Caveats">Security Levels and Caveats</a></li>
<li class="level2"><a href="#Record_Locations">Record Locations</a></li>
<li class="level2"><a href="#Record_Contacts">Record Contacts</a></li>
<li class="level2"><a href="#Creating_a_Document">Creating a Document</a></li>
<li class="level2"><a href="#Titling_and_numbering">Titling and numbering</a></li>
<li class="level2"><a href="#Assigning_to_a_container">Assigning to a container</a></li>
<li class="level2"><a href="#Attaching_an_electronic_document">Attaching an electronic document</a></li>
<li class="level2"><a href="#Document_Author">Document Author</a></li>
</ul>
</li>
<li class="level1"><a href="#Locations">Locations</a><ul><li class="level2"><a href="#Working_with_Locations">Working with Locations</a></li>
<li class="level2"><a href="#Finding_a_Person_by_Name">Finding a Person by Name</a></li>
<li class="level2"><a href="#Creating_a_new_Staff_Member">Creating a new Staff Member</a></li>
</ul>
</li>
<li class="level1"><a href="#Searching_Content_Manager">Searching Content Manager using the .NET SDK</a><ul><li class="level2"><a href="#Searching_for_Records_Manager_objects">Searching for Content Manager objects</a></li>
<li class="level2"><a href="#Specifying_the_search_criteria">Specifying the search criteria</a></li>
<li class="level2"><a href="#Retrieving_the_results">Retrieving the results of the search</a></li>
</ul>
</li>
<li class="level1"><a href="#Other_search_features">Other search features</a><ul><li class="level2"><a href="#Purpose_filtering">Purpose filtering</a></li>
<li class="level2"><a href="#Persisting_a_search">Persisting a search</a></li>
<li class="level2"><a href="#search_count">Count</a></li>
<li class="level2"><a href="#sort_by_field">Sorting by User Defined Fields</a></li>
</ul>
</li>
<li class="level1"><a href="#document_integrity_checker">Document Integrity Checker</a><ul><li class="level2"><a href="#example_running_document_store_integrity_check">Example: Running Document Store Integrity Check</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="programming_in"></a>
Introduction</h1>
<h2><a class="anchor" id="main_objects"></a>
The main objects</h2>
<p>The .NET SDK has a few of abstract classes from which the rest of its objects descend. They are:</p><ul>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_object.html" title="ApiTrimObject ">HP.HPTRIM.SDK.TrimObject</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html" title="ApiTrimMainObject ">HP.HPTRIM.SDK.TrimMainObject</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html" title="ApiTrimChildObject ">HP.HPTRIM.SDK.TrimChildObject</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_child_object_list.html" title="ApiTrimChildObjectList ">HP.HPTRIM.SDK.TrimChildObjectList</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html" title="The TrimMainObjectSearch represents a collection of TrimMainObjects that can be enumerated. It basically represent a database query, and so it it works a little differently to a static array. It is designed for performance to prefetch only the next batch of items, as Trim databases can quite often contain very large collections. ">HP.HPTRIM.SDK.TrimMainObjectSearch</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_property_set.html">HP.HPTRIM.SDK.TrimPropertySet</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_user_option_set.html" title="The ApiTrimUserOptionSet is a generic base class for about 20 or so user option groupings. User options are typically per-user preferences affecting such things as the screen display options, check in preferences, etc. ">HP.HPTRIM.SDK.TrimUserOptionSet</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_search_stack_item.html" title="The TrimSearchStackItem is an abstract base class representing an item that participates in the defin...">HP.HPTRIM.SDK.TrimSearchStackItem</a></li>
</ul>
<p>Most objects in the .NET SDK have their own constructors and can be created directly. If while programming an API based application you are unsure about how to perform a specific Content Manager function it is often helpful to see how the function is performed in the Content Manager Client.</p>
<h2><a class="anchor" id="application_object"></a>
Using the Trim Application object</h2>
<p>This object has methods and properties which describe and adjust the environment which your application is running in. Two important methods are:</p><ul>
<li>Initialize() – As previously mentioned.</li>
<li>RuntimeEnvironment = <a class="el" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af3af65bfb576e8b1f09a34e30dd0e0bb">Environments</a> This tells Content Manager what the runtime environment of this application is. Content Manager will then make changes to its behavior necessary for that environment.</li>
</ul>
<h2><a class="anchor" id="database_object"></a>
Using the Database object</h2>
<p>The <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a> object is one of the main objects managing other Content Manager API objects. The Database object is responsible for managing the session connection to a Content Manager Workgroup Server.</p>
<p>The Database object is a Creatable object, meaning that you can use the ‘New’ keyword to construct a new instance of it. Before the actual connection is created you might specify the ID of the database to use and the location of the Workgroup Server’s name or URL address to use.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a> objDB = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a>())</div><div class="line">    objDB.Id = <span class="stringliteral">&quot;PD&quot;</span>; <span class="comment">//every Content Manager Database has a two character id</span></div><div class="line">    objDB.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div><div class="line">    objDB.Connect(); <span class="comment">// throws an exception if the connection fails</span></div><div class="line">}</div></div><!-- fragment --><p> If the ID and WorkgroupServerName (or URL address) property of the Database are not specified a connection will be made to the users default database when required. If the user has not specified a default database in this situation an exception will be thrown.</p>
<h1><a class="anchor" id="creating_records"></a>
Creating and modifying Records</h1>
<h2><a class="anchor" id="new_record"></a>
Creating new Records</h2>
<p>Before creating a new <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a> you need to load a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_type.html">RecordType</a> object which specifies the type of Record you are creating. After creating a record or changing an existing record you need to save it.</p>
<h3>Code example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><span class="comment">// You will need to modify the records properties</span></div><div class="line">objRec.Save();</div></div><!-- fragment --> <h2><a class="anchor" id="access_existing_record"></a>
Accessing existing records</h2>
<p>To read information stored on records in an Content Manager database, the API programmer must first determine how to access the records required. If a particular record’s internal or external unique identifier is known, the associated record can be accessed directly and efficiently using the Record’s constructor. If neither of these unique identifiers is known, it will be necessary to construct a search.</p>
<h2><a class="anchor" id="get_existing_record"></a>
Getting a record by record number</h2>
<p>Every <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a> in Content Manager has a unique record number. This follows a pattern defined by the record type and can be manually entered by the user or set to be automatically generated by Content Manager. Although the commonly used term is ‘number’, it is more correctly an identifier, as it is a string that may contain alphanumeric characters. This string is accessible through the Record object’s Number property.</p>
<p>The record number can be used as the argument to be passed to the Record object’s constructor, which takes the current database and a variant for the unique identifier and returns a pointer to the instantiated record.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><span class="comment">// This statement instantiates Record 2015/0059 by expanded record number</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRecord = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;2015/0059</span></div></div><!-- fragment --> <blockquote class="doxtable">
<p><b>Note:</b> Content Manager stores the record number in two formats, expanded (e.g. "2015/0059") and compressed (e.g. "15/59"). Either can be substituted above. </p>
</blockquote>
<h2><a class="anchor" id="record_by_uri"></a>
Getting a Record by URI</h2>
<p>The Unique Row Identifier or URI of a record is an internal unique number that is transparent to the everyday user of Content Manager. It is the primary key on the TSRECORD table in the database and provides an internal unique identifier for every record. The URI can be used as the argument to be passed to the Record object’s constructor, similarly to the previous example.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><span class="comment">// This statement instantiates a record by its URI</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRecord = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, 130);</div></div><!-- fragment --><p> Once a record object has been created, the programmer can access properties and call methods on the object. These are discussed in the following subsections.</p>
<h1><a class="anchor" id="reading_record_data"></a>
Reading record data</h1>
<h2><a class="anchor" id="reading_basic_properties"></a>
Basic properties</h2>
<p>Most of the metadata directly associated with a record is exposed through properties on the Record object. Most properties return primitive data types (strings, numbers or dates) and can be interrogated directly. The meanings of these properties are generally self-evident from their names, but are also given in the object browser.</p>
<h3>Examples of basic readable properties of a record are:</h3>
<table class="doxtable">
<tr>
<th>Property </th><th>Example Value  </th></tr>
<tr>
<td>Number </td><td>"G1997/0770" </td></tr>
<tr>
<td>Title </td><td>"Greenhouse Journal of Global Warming - Dugong Habitats" </td></tr>
<tr>
<td>DateCreated </td><td>8/20/1997 </td></tr>
<tr>
<td>ExternalId </td><td>"GJGW 97PB" </td></tr>
<tr>
<td>AccessionNumber </td><td>5617 </td></tr>
</table>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> ((objRec.AccessionNumber &gt; 5000) &amp;&amp;</div><div class="line">    (objRec.DateCreated &lt; TrimDateTime.Parse(<span class="stringliteral">&quot;01/01/2000&quot;</span>)))</div><div class="line">{</div><div class="line">    MessageBox.Show (objRec.Title, <span class="stringliteral">&quot;Record &quot;</span> + objRec.Number.ToString());</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="related_objects"></a>
Accessing related objects</h2>
<p>Many attributes of a Content Manager <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a> represent other objects, such as the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_type.html">RecordType</a>, <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html">Classification</a> and Container attributes. These are properties where the data type of the property is an object.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(<span class="stringliteral">&quot;G97/770&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objCont = objRec.Container;</div><div class="line">MessageBox.Show(objCont.Number.ToString());</div></div><!-- fragment --><h2><a class="anchor" id="record_Location_info"></a>
Accessing record Location information</h2>
<p>A Content Manager record has various properties concerning related location information. These properties of a Record all return an instantiated Location object:</p><ul>
<li>HomeLocation – normal <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_location.html">Location</a> of the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a></li>
<li>OwnerLocation – Location of the owner or responsible unit for the record</li>
<li>Author – person who authored the electronic document</li>
<li>Creator – person who registered the record in Content Manager</li>
<li>Addressee– person to whom the record is addressed</li>
<li>PrimaryContact – the main contact person (or organization) for the record</li>
</ul>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(<span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = objRec.Author; <span class="comment">// get the author location object</span></div><div class="line">MessageBox.Show (<span class="stringliteral">&quot;Author’s name is: &quot;</span> + objLoc.FullFormattedName);</div></div><!-- fragment --><h1><a class="anchor" id="updating_records"></a>
Updating records</h1>
<p>So far we have only considered the methods for reading information from records in Content Manager. The API also allows you to update Content Manager records, either by updating the values of properties on a given record object, or by calling methods on the record. Updating properties is the simplest way to modify the metadata of a record. You simply assign a new value of the correct data type to the named property of the object. Field-level verification is carried out, and an error will be raised if the property update is invalid (see also the section on ‘Verifying’ below). For more complicated types of update to a record, you must generally call methods that instruct Content Manager to modify the record, based on arguments passed.</p>
<h2><a class="anchor" id="modifying_properties"></a>
Modifying properties</h2>
<p>The simplest way to update data in a Content Manager record is to modify the named properties on the Record object. This can only be done on properties that are not marked as read-only. This includes most of the Date properties, certain Location properties (Author, Addressee and OtherContact) and miscellaneous properties such as ExternalReference, Priority, AccessionNumber and ForeignBarcode.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = (<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>)objDB.FindTrimObjectByName(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, <span class="stringliteral">&quot;D15/2&quot;</span>);</div><div class="line">If (objRec != null)</div><div class="line">{</div><div class="line">    objRec.TypedTitle = <span class="stringliteral">&quot;New title for this record&quot;</span>;</div><div class="line">    objRec.DateDue = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddDays(7); <span class="comment">//Due in 7 days</span></div><div class="line">    objRec.DatePublished = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today;</div><div class="line">    objRec.Author = objDB.CurrentUser;</div><div class="line">    objRec.Save();</div><div class="line">)</div></div><!-- fragment --><h2><a class="anchor" id="update_methods"></a>
Calling update methods</h2>
<p>To update other data on a record where read-write properties are not available, you must call a method instead. Update methods often begin with the prefix ‘Set…’ and they include a parameter for the new data value you wish to apply.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objCreator = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Peter Abbott&quot;</span>); <span class="comment">// get the location</span></div><div class="line">objRec.SetCreatorLocation(objCreator); <span class="comment">// set the creator</span></div><div class="line">objRec.Save();</div></div><!-- fragment --><p> In many cases other parameters can be specified that control the behavior of the update:</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div><div class="line">objRec.SetAssignee(objDB.CurrentUser(), null, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddDays(-1)); <span class="comment">// set</span></div><div class="line">the <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af7cf3e59ba37f4602c19017ad305a942a780f85493892dc48b674ac9da8974133">Assignee</a></div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="updating_properties"></a>
Updating properties using SetProperty</h2>
<p>To update a record’s properties where the internal identifier of the property is known, you can use the SetProperty method. This requires passing the property identifier and a variant containing the data value.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div><div class="line">objRec.SetProperty(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a42b30f289efa9bf64150279dbb479586">PropertyIds</a>.RecordTitle, <span class="stringliteral">&quot;New Title&quot;</span>); <span class="comment">// Set the title</span></div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="update_user_defined_fields"></a>
User Defined Fields</h2>
<p>Content Manager allows user-defined fields to be assigned to records. These user-defined fields cannot be interrogated using normal named properties of the record object. Instead, accessing user defined fields is carried out using a dedicated object for managing these fields</p><ul>
<li>the FieldDefinition object. Each base object has a pair of methods for manipulating user-defined fields, GetFieldValue and SetFieldValue. Each method takes a populated FieldDefinition object as a parameter.</li>
</ul>
<h3>Code Example (GetFieldValue)</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a> fdDocType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a>(objDB, <span class="stringliteral">&quot;Document Type*&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af57fc055b8a60734f55b6a295aec747da97427013ed5e27f28073c25dc0535345">UserFieldValue</a> ufvDocType = objRec.GetFieldValue(fdDocType);</div><div class="line">MessageBox.Show(ufvDocType.ToString());</div></div><!-- fragment --><h3>Code Example (SetFieldValue)</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div><div class="line">FieldDefinitionList udfs = objRec.RecordType.UserFields;</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af57fc055b8a60734f55b6a295aec747da97427013ed5e27f28073c25dc0535345">UserFieldValue</a> ufvCurrent = null;</div><div class="line"><span class="keywordflow">foreach</span> (FieldDefinition udf <span class="keywordflow">in</span> udfs)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (udf.Format)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aa1297d5761569bb0e5b4ffa4532467fe">UserFieldFormats</a>.Datetime:</div><div class="line">        TrimDateTime tdta = <span class="keyword">new</span> TrimDateTime(<span class="stringliteral">&quot;2015-01-01&quot;</span>);</div><div class="line">        ufvCurrent = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af57fc055b8a60734f55b6a295aec747da97427013ed5e27f28073c25dc0535345">UserFieldValue</a>(tdta);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aa1297d5761569bb0e5b4ffa4532467fe">UserFieldFormats</a>.String:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aa1297d5761569bb0e5b4ffa4532467fe">UserFieldFormats</a>.Text:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aa1297d5761569bb0e5b4ffa4532467fe">UserFieldFormats</a>.Xml:</div><div class="line">        ufvCurrent = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af57fc055b8a60734f55b6a295aec747da97427013ed5e27f28073c25dc0535345">UserFieldValue</a>(<span class="stringliteral">&quot;Freddy&quot;</span>);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">…</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (ufvCurrent != null)</div><div class="line">    {</div><div class="line">        objRec.SetFieldValue(udf, ufvCurrent);</div><div class="line">    }</div><div class="line">}</div><div class="line">objRec.Save();</div></div><!-- fragment --><h1><a class="anchor" id="Verifying_and_error_trapping"></a>
Verifying and error trapping</h1>
<p>When a record object is modified via the API, there are two levels of verification that must be carried out before the changes can be committed to the database. The first is field-level verification, which checks that the change to an individual property is legal. An example would be that the Date Registered is not in the future. If a property update cannot be carried out because of field-level verification, the method call or property assignment will cause a run-time error to be raised and the update will not be carried out. The second level of validation is object-level verification (sometimes called cross-field verification). This checks that the values of all fields on the object are consistent with each other. An example of object-level verification would be that the Date Registered is not earlier than the Date Created. Objectlevel verification is performed when the object’s Verify or Save methods are called.</p>
<h2><a class="anchor" id="The_Verify_method"></a>
The Verify method</h2>
<p>Every base object has a ‘Verify’ method. This can be called to perform object-level verification prior to saving the object. The method returns false if there are any errors in the state of the object, and the error description will be stored in the object’s ErrorMessage property. If there are no errors, the method returns true and the Verify property (see below) is set to true. The method contains an optional parameter "failOnWarning" which, if set to true, will cause the Verify method to check for warning conditions as well as error conditions, and to fail if a warning is encountered.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> (objRec.Verify(<span class="keyword">true</span>))</div><div class="line">{</div><div class="line">    MessageBox.Show (objRec.ErrorMessage, <span class="stringliteral">&quot;Verify Failed&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">    objRec.Save();</div><div class="line">}</div></div><!-- fragment --><p> If it is not called explicitly in code, the Verify method will be automatically called before an object is saved (see below) and if verification fails it will not be saved. This ensures that data cannot become corrupted and that business rules are observed when using the API, just as they are for users of the Content Manager Client interface.</p>
<h2><a class="anchor" id="The_Verified_property"></a>
The Verified property</h2>
<p>Every base object also has a ‘Verified’ Boolean read-only property, which is false whenever the object is instantiated. It is set to true when the Verify method confirms that it is in a legal state to be saved to the database (regardless of warning conditions).</p>
<h2><a class="anchor" id="Trapping_run-time_errors"></a>
Trapping run-time errors</h2>
<p>It is up to the programmer to determine how they wish to deal with possible errors when updating an object. However, they must be aware that error checking takes place even when directly updating properties, so it will be necessary to provide some error-trapping code to prevent run-time errors being displayed to the user if there is a possibility of errors being raised.</p>
<h2><a class="anchor" id="Saving_the_record_to_the_database"></a>
Saving the record to the database</h2>
<p>All of the update methods and property changes made through the Record interface are only applied to the object in memory. The changes are not committed on the Content Manager database until the object is saved. Calling the Save method on the record object will commit the changes to the database, applying all updates since the object was instantiated (or since it was last saved). Note that if the record has not been verified, Save will automatically call the Verify method and will only commit the changes if the verification succeeds. Various code examples using this method can be found throughout this document.</p>
<h1><a class="anchor" id="New_records_and_electronic_documents"></a>
New records and electronic documents</h1>
<h2>Creating a container file</h2>
<p>This scenario describes the general processes for using the SDK to create a record of a generic record type we are calling a ‘Container File’. In this and the next scenario (Creating a Document) we are assuming that the reader is familiar with the concept of record types. While it is up to the administrator of each Content Manager implementation to determine the record types to be used, it is typical to follow a standard records management practice of having at least two record types, one representing container files (or folders) and one representing documents (the actual names used for the record types may of course vary). Container files are usually created and maintained by specialist records managers, as it is generally at this level that classification systems, retention schedules, security, keywords, controlled titling and other records management metadata are applied. Documents, on the other hand, are usually created by end-users, and require little specific metadata other than the identification of the appropriate container file to which the document belongs, as all other metadata and context is inherited from the Container. The general steps for creating a new container file record are as follows:</p><ol type="1">
<li>Instantiate the appropriate Record Type object</li>
<li>Instantiate a new record object of this type</li>
<li>Identify the Classification or keywords for titling the record (optional)</li>
<li>Set the free text title</li>
<li>Assign security levels and caveats (optional)</li>
<li>Relate the record to associated Locations (optional)</li>
<li>Relate to other records (optional)</li>
<li>Assign other metadata or user-defined fields (optional)</li>
<li>Assign a record identifier</li>
<li>Save the Record object</li>
</ol>
<h2><a class="anchor" id="Creating_a_record_of_a_given_type"></a>
Creating a record of a given type</h2>
<p>When creating any record, the Record Type for the new record must be identified. This is passed to the record object’s constructor along with the database which the new record is to belong to. See the <a class="el" href="programming_guide.html#new_record">Creating new records example</a>. </p><blockquote class="doxtable">
<p><b>Note:</b> It is possible to create new Record Types using the SDK; however, this is not recommended as this is generally an administrator’s function only. </p>
</blockquote>
<h2><a class="anchor" id="Controlled_and_free_text_titling"></a>
Controlled and free text titling</h2>
<p>Titles for container files are often subject to controlled vocabulary or classification structures such as a thesaurus or file plan, which give records managers’ greater control over file creation, retrieval and retention. Even when such controlled titling is used, each file will typically also have a ‘free text’ title part. The titling method used is determined by the record type, and is usually set by the Records Manager administrator. Thus a record with Classification titling may have a title such as: "Insurance – Property – Storm damage to Mackay information center", where the first two terms are generated from a predefined hierarchical classification structure and the remaining part of the title is ‘free text’ describing the specifics of the file. The generated title terms are determined by the lassification codes, usually defined as a numerical sequence such as "610/600/". The free text title is set via the TypedTitle property.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;TestingClass&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><span class="keywordflow">if</span> (objRecType.TitlingMethod == <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a34bd63e30f0cfebb19e56e604eda9a1a">TitlingMethods</a>.Classification)</div><div class="line">{</div><div class="line">    <span class="comment">// Assign classification of 610/600/ = Insurance - Property</span></div><div class="line">    objRec.Classification = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a>(objDB, <span class="stringliteral">&quot;610/600/&quot;</span>);</div><div class="line">    objRec.TypedTitle = <span class="stringliteral">&quot;Storm damage to Mackay information center&quot;</span>;</div><div class="line">    MessageBox.Show(objRec.GeneratedTitle); <span class="comment">// &quot;Insurance - Property&quot;</span></div><div class="line">}</div><div class="line">objRec.Save();</div></div><!-- fragment --><p>Similarly, Thesaurus or Keyword titling allows a file to be titled using either a choice of individual keywords from a controlled list or a specific ‘branch’ of related terms according to a hierarchical structure (similar to a record plan or classification).</p>
<h2><a class="anchor" id="Security_Levels_and_Caveats"></a>
Security Levels and Caveats</h2>
<p>The security profile of an individual Content Manager record is governed by three security controls: a Security Level, a set of zero or more Caveats, and Access Control. Security Levels and Caveats determine the access that a Content Manager user has to the metadata of a record. These security specifications are usually applied to Record Types (and inherited by records of each type when they are created) but can be set explicitly on individual records. Every user has a maximum security level and zero or more caveats – in order to access a particular record, the user must have the same or a higher security level and must have all the caveats associated with the record.</p>
<p>There are two ways to assign Security Levels and Caveats to a record via the SDK. If the value and number of Levels and Caveats are fixed then this method can be used.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line">objRec.Security = <span class="stringliteral">&quot;Confidential, Caveat1, Caveat2&quot;</span>;</div><div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Security Profile Example&quot;</span>);</div><div class="line">objRec.Save();</div></div><!-- fragment --><p>The more preferred way (although more verbose) is to retrieve the level and caveats, add them to a security profile and assigning the profile to the record. Both the SecurityLevel object and the SecurityCaveat objects can be instantiated by full name or by abbreviation. The instantiated SecurityLevel object can then be assigned to a TrimSecurityProfile’s SecurityLevel property. Each instantiated SecurityCaveat object can be added via the SecurityProfile’s AddCaveat method. The SecurityProfile can then be assigned to a record’s SecurityProfile property.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212af3447fcb20374e5b7d409751ec8cf7a3">SecurityLevel</a> secLevel = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212af3447fcb20374e5b7d409751ec8cf7a3">SecurityLevel</a>(objDB, <span class="stringliteral">&quot;Unclassified&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a> secCaveat1 = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a>(objDB, <span class="stringliteral">&quot;Caveat1&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a> secCaveat2 = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a>(objDB, <span class="stringliteral">&quot;Caveat2&quot;</span>);</div><div class="line">TrimSecurityProfile secProfile;</div><div class="line">secProfile = objRec.SecurityProfile;</div><div class="line">secProfile.SecurityLevel = secLevel;</div><div class="line">secProfile.AddCaveat(secCaveat1);</div><div class="line">secProfile.AddCaveat(secCaveat2);</div><div class="line">objRec.SecurityProfile = secProfile;</div><div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Security Profile Example&quot;</span>);</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Record_Locations"></a>
Record Locations</h2>
<p>Defining relationships between a container file and location objects (people and places) provides additional and useful context for the record. Unlike record relationships, which can be user-defined, you can only use Content Manager’s predefined standard relationship types for record locations. Record Locations represent actual (in the case of paper and other physical records) or logical (in the case of electronic records) places where a record resides. Every record in Content Manager has a property representing its Home Location (where the record should normally be). There is also a property for Owner Location – the exact meaning of this can vary according to the practices of each Content Manager implementation, but normally represents the person or body that is responsible for the record. The Home and Owner location of a record are typically derived from the default values for each Record Type, but all record location properties can be set on creation of a new record or modified later. The record object has methods for setting or changing the value of these location properties, which allow the option of specifying the date &amp; time of the change of location (the default is the current time).</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objLocation = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Administration&quot;</span>);</div><div class="line">objRec.SetHomeLocation (objLocation);</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Record_Contacts"></a>
Record Contacts</h2>
<p>Unlike record Locations which tend to be internal units, Record Contacts are more commonly people or organizations that have a direct association with the record, and may be internal or external to the organization. Using the AttachContact method, Content Manager allows each contact to be specifically identified as an Author, Addressee, Representative or Client. Other contact relationship types must use the generic type of ‘Other’.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objContact2 = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Hewlett Packard Enteprise&quot;</span>);</div><div class="line">objRecord.AttachContact (objDB.CurrentUser, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af1efc147c529d186829b5008bb8d73af">ContactType</a>.Representative, <span class="keyword">true</span>);</div><div class="line">objRecord.AttachContact (objContact2, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af1efc147c529d186829b5008bb8d73af">ContactType</a>.Client, <span class="keyword">true</span>);</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Creating_a_Document"></a>
Creating a Document</h2>
<p>This scenario describes the general processes for using the SDK to create a record of a generic Record Type we are calling a ‘Document’.</p>
<p>While container files are usually created and maintained by specialist records managers, documents, on the other hand, are usually created by end-users, and require little specific metadata other than the identification of the appropriate container file to which the document belongs, as most other metadata and context is inherited from the container. A document record usually consists of an electronic object (the source document, image or other file), a unique identifier (which may be automatically generated by Content Manager), a record title and any other metadata required to profile and index the record, and a pointer to the container file from which the document derives its context.</p>
<p>The general steps for creating a new document record are as follows:</p><ol type="1">
<li>Instantiate the appropriate Record Type object</li>
<li>Instantiate a new record object of this type</li>
<li>Identify the container file for the document</li>
<li>Set the free text title</li>
<li>Attach an electronic file</li>
<li>Assign the record’s Author or other contacts (optional)</li>
<li>Set Access Control to the electronic document (optional)</li>
<li>Assign other metadata or user-defined fields (optional)</li>
<li>Save the record object</li>
</ol>
<h2><a class="anchor" id="Titling_and_numbering"></a>
Titling and numbering</h2>
<p>Titling for documents is generally straightforward – free text titling is the norm, and the title simply needs to succinctly describe the document or record. Record numbers may be assigned explicitly or they may be automatically generated – this is configured on the Record Type properties. If the number is explicitly assigned, the number (in expanded format) must be assigned to the LongNumber property (it must be unique or the record will not be saved).</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Testing Long Numbers&quot;</span>;</div><div class="line">objRec.LongNumber = <span class="stringliteral">&quot;XK/008934&quot;</span>;</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Assigning_to_a_container"></a>
Assigning to a container</h2>
<p>Although it is not compulsory, it is most common that an electronic record is logically assigned to a container file that represents the subject matter, case, client file or other contextual grouping relevant to the document.</p>
<p>To assign a record to a container, the existing container record must be instantiated (by Id or URI) and then passed as an argument to the (contained) record object’s SetContainer method. The method includes a parameter for specifying whether the record is also ‘enclosed in’ the container, i.e. that the current location should reflect that it is with the container.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType2 = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Folder&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objContainer = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType2);</div><div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Testing Long Numbers&quot;</span>;</div><div class="line">objRec.SetContainer(objContainer, <span class="keyword">true</span>);</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Attaching_an_electronic_document"></a>
Attaching an electronic document</h2>
<p>Document records can represent physical paper documents, but mostly they will include an electronic attachment, whether this is a word-processing document, scanned image or other type of file. To attach an electronic document to a record, the file name and path must be used to instantiate an InputDocument object. This object is then passed as an argument to the record object’s SetDocument method. The method includes parameters for specifying whether this should replace any existing document (or be added as a new revision), whether it should be marked as checked out to the current user, and any comments to be added to the record’s Notes field. The title of the document (minuse the extension) becomes the title of the record by default.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div><div class="line">InputDocument objDoc = <span class="keyword">new</span> InputDocument();</div><div class="line">objDoc.SetAsFile(<span class="stringliteral">@&quot;C:\temp\samples.txt&quot;</span>);</div><div class="line">objRec.SetDocument(objDoc, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;Created via SDK&quot;</span>);</div><div class="line">objRec.Save();</div></div><!-- fragment --><h2><a class="anchor" id="Document_Author"></a>
Document Author</h2>
<p>Record Contacts are Content Manager location objects commonly representing people or organizations that have a direct association with the record. The most common type of Contact to be specified for an electronic document is the Author. Although the AttachContact method can be used for this and other contact types, a shortcut is provided through the Author property. For examples how to do this, see the code examples for:</p><ul>
<li><a class="el" href="programming_guide.html#record_Location_info">Accessing record Location information</a></li>
<li><a class="el" href="programming_guide.html#modifying_properties">Modifying properties</a></li>
<li><a class="el" href="programming_guide.html#Record_Contacts">Record Contacts</a></li>
</ul>
<h1><a class="anchor" id="Locations"></a>
Locations</h1>
<h2><a class="anchor" id="Working_with_Locations"></a>
Working with Locations</h2>
<p>The Location object is an encapsulation of all properties and methods associated with Persons, Organizations, Positions and Groups. Locations can be identified by name or by URI, and can be selected on other criteria, such as date of birth, nicknames, or membership of a particular organization, role or group.</p>
<h2><a class="anchor" id="Finding_a_Person_by_Name"></a>
Finding a Person by Name</h2>
<p>Although the names of non-persons (Units, Positions and Organizations) must be unique, this is not the case for persons (Staff Names &amp; Contacts). However, Content Manager allows you to store a ‘nickname’ for any person, and this can be used as a substitute for a person’s name when searching. To find a particular person by name, you must pass the person’s combined name and title to the Location object’s constructor.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(<span class="stringliteral">&quot;Abbott, Peter (Mr)&quot;</span>);</div></div><!-- fragment --><p>If the sub-string does not uniquely identify a location (i.e. there are no matches, or there is more than one match) then a null object will be returned.</p>
<h2><a class="anchor" id="Creating_a_new_Staff_Member"></a>
Creating a new Staff Member</h2>
<p>To create a new staff member, you must instantiate a new location by calling the Location’s constructor. You then define the type of the location by assigning a value (in this case Person) to the TypeOfLocation property. You can then set various properties representing the person’s name, contact details such as telephone numbers and addresses, administrative details such as employee id numbers and so on.</p>
<p>If the new person is to be a Content Manager user, then there are login and security details to be provided. You will need to specify the user’s network login id and optionally an expiry date. For the security profile, you are required to either explicitly state the user’s security level (and optionally any Caveats) and a user category, or if role-based security is used you can specify that the user takes the profile of a predefined group or user.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objRole = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Executive&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB);</div><div class="line">objLoc.TypeOfLocation = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aa8a81e5bbcd47b5bd180500d46cea797">LocationType</a>.Person;</div><div class="line"><span class="comment">// Name</span></div><div class="line">objLoc.Surname = <span class="stringliteral">&quot;Evans&quot;</span>;</div><div class="line">objLoc.GivenNames = <span class="stringliteral">&quot;David&quot;</span>;</div><div class="line">objLoc.Initials = <span class="stringliteral">&quot;D&quot;</span>;</div><div class="line">objLoc.Honorific = <span class="stringliteral">&quot;Mr&quot;</span>;</div><div class="line"><span class="comment">// Personal &amp; Administrative</span></div><div class="line">objLoc.IsWithin = <span class="keyword">true</span>; <span class="comment">// Internal</span></div><div class="line">objLoc.IdNumber = <span class="stringliteral">&quot;793906&quot;</span>;</div><div class="line">objLoc.ReviewDate = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddYears(1);</div><div class="line">objLoc.DateOfBirth = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Parse(<span class="stringliteral">&quot;11/29/1976&quot;</span>);</div><div class="line">objLoc.PhoneNumber = <span class="stringliteral">&quot;555 123496&quot;</span>;</div><div class="line">objLoc.MobileNumber = <span class="stringliteral">&quot;+44 7939 062736&quot;</span>;</div><div class="line">objLoc.Notes = <span class="stringliteral">&quot;Created via SDK&quot;</span>;</div><div class="line"><span class="comment">// Login Details</span></div><div class="line">objLoc.CanLogin = <span class="keyword">true</span>;</div><div class="line">objLoc.LoginExpires = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a078ff74f20884ce14a530739311580e8a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddYears(3); <span class="comment">// Valid for 3 years</span></div><div class="line">objLoc.LogsInAs = <span class="stringliteral">&quot;evansd&quot;</span>; <span class="comment">// Network ID login</span></div><div class="line"><span class="comment">// Security</span></div><div class="line">objLoc.UseProfileOf = objRole;</div><div class="line"><span class="comment">// Confirm &amp; Save</span></div><div class="line"><span class="keywordflow">if</span> (objLoc.Verify(<span class="keyword">true</span>))</div><div class="line">{</div><div class="line">    objLoc.Save();</div><div class="line">    MessageBox.Show(objLoc.FormattedName + <span class="stringliteral">&quot; created.&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">    MessageBox.Show(objLoc.ErrorMessage);</div><div class="line">}</div></div><!-- fragment --><p>Relationships such as membership of units or reporting lines are created using the AddRelationship method and passing parameters for the related location and the relationship type.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objGroup = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Board of Directors&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objMember = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Evans, David (Mr)&quot;</span>);</div><div class="line">objMember.AddRelationship(objGroup, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#ac3c8a2ef68348bdbe1340225ee0661ec">LocRelationshipType</a>.MemberOf, <span class="keyword">true</span>);</div><div class="line">objMember.Save();</div></div><!-- fragment --><p>Addresses (including electronic addresses such as email or URL) are added by calling the New method on the location’s ChildAddresses or ChildEAddresses collection properties.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a> objPerson = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Evans, David (Mr)&quot;</span>);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a806e4d900157520fbb929a41329c8b97">LocationEAddress</a> objEmail = objPerson.ChildEAddresses.New();</div><div class="line">objEmail.ElectronicAddressData = <span class="stringliteral">&quot;evansd@gmail.com&quot;</span>;</div><div class="line">objEmail.ElectronicAddressType = <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#acb703303f157722931f9ad48ecd66d28">EAddressType</a>.Mail;</div><div class="line">objPerson.Save();</div></div><!-- fragment --><h1><a class="anchor" id="Searching_Content_Manager"></a>
Searching Content Manager using the .NET SDK</h1>
<h2><a class="anchor" id="Searching_for_Records_Manager_objects"></a>
Searching for Content Manager objects</h2>
<p>One of the most powerful features of Content Manager is the wide range of search criteria that can be applied to select obects from the database. .NET SDK provides the TrimMainObjectSearch class to provide this functionality. This class allows you to combine a number of search criteria together using boolean logic and then iterate through a resulting set of objects. Note that the TrimMainObjectSearch class can only be used to search for objects of a specified type, for instance, you can create a TrimMainObjectSearch to retrieve records. As its name implies, this class can be used to search for any SDK object that inherits from TrimMainObject.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch records = <span class="keyword">new</span> TrimMainObjectSearch(db, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record);</div><div class="line">records.SelectAll();</div></div><!-- fragment --><h2><a class="anchor" id="Specifying_the_search_criteria"></a>
Specifying the search criteria</h2>
<p>The TrimMainObjectSearch class provides a number of simple "canned" methods for searching that do not involve any boolean logic. These are simple to use if you have a straightforward query, they include:</p><ul>
<li>SelectByPrefix</li>
<li>SelectFavorites</li>
<li>SelectByUserLabel</li>
<li>SelectNone</li>
<li>SelectAll</li>
<li>SelectByUris</li>
<li>SelectTopLevels</li>
<li>SelectThoseWithin</li>
</ul>
<p>To use the string search syntax available in Content Manager (refer to the Content Manager’s Help file for examples). There are three main components to a string search – the primary search string, a set of filters (these work as if they were combined with the primary search string using a boolean ‘and’) and the sort specification. To create a query in this way, you use the SetSearchString method to specify the primary search string, and then you can optionally specify any filters using SetFilterString and specify a sort using AddSortItemAscending/AddSortItemDescending. This approach is useful if you want to provide the user with a simple edit control for specifying a search, and is also very useful for web-based applications.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch objSearch = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record);</div><div class="line">objSearch.SetSearchString(<span class="stringliteral">&quot;createdOn:this year and creator:me&quot;</span>);</div><div class="line">objSearch.SetFilterString(<span class="stringliteral">&quot;type:document&quot;</span>);</div><div class="line">objSearch.SetSortString(<span class="stringliteral">&quot;createdOn&quot;</span>);</div><div class="line">MessageBox.Show(objSearch.FastCount.ToString());</div></div><!-- fragment --><p>Another option is to work with TrimSearchStackItem objects. The primary search criteria is represented internally as an array of TrimSearchStackItem objects, arranged as a reverse-polish stack to indicate operator precedence. A TrimSearchStackItem can be an operator (TrimSearchOperator) or a search clause (TrimSearchClause). You can build up a query using the internal search stack of the TrimMainObjectSearch, by using such methods as AddSearchClause, And, Or and Not. A read of the Wikipedia article on Reverse Polish notation would be most beneficial for developers unfamiliar with this style of expression. Because filters are all automatically "and-ed" together, they are simply represented as an array of TrimSearchClause items. For sorting, there is a TrimSearchSortItem class and a corresponding array.</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch objSearch = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record);</div><div class="line">TrimSearchClause objClause1 = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record,</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aaea0586882a820c16f4140677ee8f11b">SearchClauseIds</a>.RecordCreatedOn);</div><div class="line">objClause1.SetCriteriaFromString(<span class="stringliteral">&quot;this year&quot;</span>);</div><div class="line"></div><div class="line">TrimSearchClause objClause2 = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aaea0586882a820c16f4140677ee8f11b">SearchClauseIds</a>.RecordCreator);</div><div class="line">objClause2.SetCriteriaFromString(<span class="stringliteral">&quot;me&quot;</span>);</div><div class="line">objSearch.AddSearchClause(objClause1);</div><div class="line">objSearch.AddSearchClause(objClause2);</div><div class="line">objSearch.And();</div><div class="line"></div><div class="line">TrimSearchClause objFilter = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aaea0586882a820c16f4140677ee8f11b">SearchClauseIds</a>.RecordType);</div><div class="line">objFilter.SetCriteriaFromString(<span class="stringliteral">&quot;document&quot;</span>);</div><div class="line">objSearch.AddFilterClause(objFilter);</div><div class="line">objSearch.AddSortItemAscending(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#aaea0586882a820c16f4140677ee8f11b">SearchClauseIds</a>.RecordCreatedOn);</div></div><!-- fragment --><p>These individual classes provide extra features that allow even more elaborate queries to be built.</p>
<h2><a class="anchor" id="Retrieving_the_results"></a>
Retrieving the results of the search</h2>
<p>The TrimMainObjectSearch derives from IEnumerable and so you can use a standard "foreach" loop to retrieve items that match the selection. In addition, there are two methods that will return the search result as an array of unique object identifiers (corresponds to the Uri property of a TrimMainObject).</p>
<h3>Code Example</h3>
<div class="fragment"><div class="line">...</div><div class="line">foreach (Record objRec in objSearch)</div><div class="line">{</div><div class="line">    MessageBox.Show(objRec.Title);</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="Other_search_features"></a>
Other search features</h1>
<h2><a class="anchor" id="Purpose_filtering"></a>
Purpose filtering</h2>
<p>You can specify that the items in the selection are eventually intended for a specific pupose. This may apply additional hidden filtering to the selection, although not always. As you are iterating through the results, you can use the IsValidForPurpose method to test if the item is suitable for the purpose specified. Each TrimMainObject has a purpose enumeration associated with it – use this enumeration to specify suitable purpose values for the object you are selecting.</p>
<h2><a class="anchor" id="Persisting_a_search"></a>
Persisting a search</h2>
<p>The TrimMainObjectSearch has a SearchAsXML property which will convert the search, filter and sort criteria to an XML string. This string is language-independent and is therefore useful if you wish to reuse the same search at some later stage, perhaps in a different locale. Item matching The TrimMainObjectSearch provides an ItemMatches method, which allows you to test whether an existing TrimMainObject matches the search criteria contained within the search.</p>
<h2><a class="anchor" id="search_count"></a>
Count</h2>
<p>There are two counts <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#adb2bb8b6ca89058c7a618374e4f23abd">FastCount</a> and <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#a2f478a8c30d8c57f8c22388be5b963ab">Count</a>. FastCount may, in the case of the use of multiple levels of inherited ACLs, return -1 rather than an actual count. Count should always return a result accurate at the time it was called. Count will first try to use FastCount, if that fails it will fetch all the Records and then loop through them to count them. So it will often be as fast as FastCount but may be a lot slower (especially for large result sets). So, use FastCount only when you need to avoid a slow response and can accept an invalid response.</p>
<h2><a class="anchor" id="sort_by_field"></a>
Sorting by User Defined Fields</h2>
<p>User Defined Fields are not indexed in the database and are this not a part of the core sorting however it is possible to sort using them. Always take care when doing this as the lack of an index requires a the entire result set to be fetched and sorted in memory. On large result sets this can be very slow. To sort using a User Defined field use either <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#a49b9512e0ed1d1da3230ee5e062ff7b9">GetEnumeratorSorted</a> or <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#ac1019a302e86734fb7c0dedac5374607">GetResultAsUriArraySorted</a>, as seen in this example:</p>
<div class="fragment"><div class="line">TrimMainObjectSearch search = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record);</div><div class="line">search.SelectAll();</div><div class="line"></div><div class="line">var enumerator = search.GetEnumeratorSorted(<span class="keyword">new</span> PropertyOrFieldDef(<span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a>(database, <span class="stringliteral">&quot;Speed&quot;</span>)), <span class="keyword">false</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">while</span> (enumerator.MoveNext())</div><div class="line">{</div><div class="line">    Console.WriteLine(<span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, (TrimURI)enumerator.Current).Title);</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="document_integrity_checker"></a>
Document Integrity Checker</h1>
<p>The document store integrity check can now be executed from the SDK. The following class and enum are introduced for the document store checker</p>
<table class="doxtable">
<tr>
<th>Type </th><th>Name  </th></tr>
<tr>
<td>Class </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_document_store_integrity_check_task.html">DocumentStoreIntegrityCheckTask</a> </td></tr>
<tr>
<td>Enum </td><td><a class="el" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af398444d023b05767abfe44575f6a96e">DocumentStoreIntegrityCheckCounter</a> </td></tr>
</table>
<h2><a class="anchor" id="example_running_document_store_integrity_check"></a>
Example: Running Document Store Integrity Check</h2>
<div class="fragment"><div class="line"><span class="keywordtype">string</span> m_workPath = <span class="stringliteral">&quot;C:\\tmp&quot;</span>;</div><div class="line">m_db = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a>();</div><div class="line">m_db.Id = m_dbId;</div><div class="line">m_db.WorkgroupServerName = <span class="stringliteral">&quot;workgroupserver&quot;</span>;</div><div class="line">m_db.WorkgroupServerPort = 1137;</div><div class="line">m_db.Connect();</div><div class="line"></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6bfdc91bc041aaf54fd7b721fcb2c239">ElectronicStore</a> storeToCheck = (<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6bfdc91bc041aaf54fd7b721fcb2c239">ElectronicStore</a>)m_db.FindTrimObjectByName(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.ElectronicStore, <span class="stringliteral">&quot;Main Document Store&quot;</span>);</div><div class="line"></div><div class="line">m_task = <span class="keyword">new</span> DocumentStoreIntegrityCheckTask(storeToCheck);</div><div class="line">m_task.FixErrors = <span class="keyword">true</span>; <span class="comment">//Set this to true if you want the checker to correct any error. </span></div><div class="line">m_task.LogPath = m_workPath + <span class="stringliteral">&quot;/StoreChecker.log&quot;</span>; <span class="comment">//The path where the checker&#39;s log will be written to</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordflow">try</span></div><div class="line">{</div><div class="line">  m_task.Run();       </div><div class="line"></div><div class="line">  <span class="comment">//If you want to get a counter for a number of corrupted document</span></div><div class="line">  m_task.GetProgressCounter(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af398444d023b05767abfe44575f6a96e">DocumentStoreIntegrityCheckCounter</a>.CorruptedDocuments);</div><div class="line"></div><div class="line">  <span class="comment">//If you want to cancel the check</span></div><div class="line">  m_task.Cancel();    </div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (TrimException trimException)</div><div class="line">{</div><div class="line">  Debug.Print(trimException.Message);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
