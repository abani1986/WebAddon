<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Micro Focus Content Manager SDK 9.3: Advanced Topics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CM_top-banner-logo_layers.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Micro Focus Content Manager SDK 9.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('advanced_topics.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Advanced Topics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ways_To_Fetch_a_TrimMainObject">Different ways to fetch a TrimMainObject</a><ul><li class="level2"><a href="#fetch_by_constructorand_name">Object constructor by Name</a></li>
<li class="level2"><a href="#object_name_properties">Object name properties</a></li>
<li class="level2"><a href="#fetch_by_database">Database find methods</a></li>
<li class="level2"><a href="#fetch_by_search">TrimMainObjectSearch</a></li>
</ul>
</li>
<li class="level1"><a href="#fetchDoc">Document access alternatives</a><ul><li class="level2"><a href="#doc_access_overview">Overview</a></li>
<li class="level2"><a href="#getDoc">Record.GetDocument</a></li>
<li class="level2"><a href="#clientCache">DocumentPathInClientCache</a></li>
<li class="level2"><a href="#wgsCache">DocumentPathInWGSCache</a></li>
<li class="level2"><a href="#downloadNotifier">DownloadNotifier</a></li>
<li class="level2"><a href="#dowload_other_object_types">Other object types</a></li>
</ul>
</li>
<li class="level1"><a href="#localisedStrings">Localised strings</a><ul><li class="level2"><a href="#trimMEssages">TrimMessages</a></li>
<li class="level2"><a href="#objectCaptions">Captions</a><ul><li class="level3"><a href="#enumCaptions">Enum captions</a></li>
<li class="level3"><a href="#propertyCaptions">Property Captions</a></li>
<li class="level3"><a href="#searchClauseCaptions">Search Clause Captions</a></li>
<li class="level3"><a href="#menuItemCaptions">Menu items</a></li>
</ul>
</li>
<li class="level2"><a href="#formDefinitionCaptions">FormDefinition</a></li>
</ul>
</li>
<li class="level1"><a href="#lookupset_Items">Fetching LookupSet Items</a><ul><li class="level2"><a href="#new_lookupitem">Example: Adding a new LookupItem</a></li>
<li class="level2"><a href="#fetching_lookup_items">Example: Fetching lookup items</a></li>
</ul>
</li>
<li class="level1"><a href="#create_record_manual_number">Create a Record using manual numbering</a><ul><li class="level2"><a href="#example_manual_record_number">Example: Manual Record Number</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="ways_To_Fetch_a_TrimMainObject"></a>
Different ways to fetch a TrimMainObject</h1>
<p>Accessing a Record is <a class="el" href="programming_guide.html#access_existing_record">discussed briefly</a> in the help but there are a variety of ways to get a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>. </p>
<h2><a class="anchor" id="fetch_by_constructorand_name"></a>
Object constructor by Name</h2>
<p>As <a class="el" href="programming_guide.html#access_existing_record">discussed</a> in the help use the Name or Uri to instantiate the object.</p>
<h3>Code example</h3>
<p>This example fetches a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html">Classification</a> by <a class="el" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a88829ac01c8adfd2c4f22183e9bf1d33ab2ee912b91d69b435159c7c3f6df7f5f">number</a>.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a> classification = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a>(database, <span class="stringliteral">&quot;Accommodation - Domestic - General&quot;</span>);</div><div class="line">Console.WriteLine(classification.Title);</div></div><!-- fragment --> <h2><a class="anchor" id="object_name_properties"></a>
Object name properties</h2>
<p>As can be seen a certain knowledge of the object type is required to fetch by name. For example the name property for each object type is different, for most object types the name property is Name, here is a list of those object types where that rule does not apply:</p>
<table class="doxtable">
<tr>
<th>Object Types </th><th>Name Property  </th></tr>
<tr>
<td>ActionDef </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_action_def.html#af63f2be6cb2ae175c1fbeb08d6fd12b7">ActionName</a> </td></tr>
<tr>
<td>AgendaItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_agenda_item.html#a103a8e8f87d7abe8f517162a032c1b86">Number</a> </td></tr>
<tr>
<td>Alert </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_alert.html#a26a79494208764db2f26dee759bdd13e">Description</a> </td></tr>
<tr>
<td>Classification </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_classification.html#a0eebc49789d4e058d571bd9c034f5640">Title</a> </td></tr>
<tr>
<td>Communication </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_communication.html#a81ca7fe5819e486aecb4ed07d469263e">Description</a> </td></tr>
<tr>
<td>Consignment </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment.html#a54c5f66ae8630564fa1d5fbb21da488e">Number</a> </td></tr>
<tr>
<td>ConsignmentApprover </td><td><a class="el" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> </td></tr>
<tr>
<td>ConsignmentIssue </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_consignment_issue.html#ad850e6c5139448cdf04d1fed6578ec40">Record</a> </td></tr>
<tr>
<td>History </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_history.html#a2b1eecdecd8dcdda799255ab802d3e0f">EventDescription</a> </td></tr>
<tr>
<td>Location </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_location.html#ae345296353d07bad35ed57fa680c4dc1">SortName</a> </td></tr>
<tr>
<td>MinuteItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_minute_item.html#a1187dd79c2748b339418393048e1b251">Description</a> </td></tr>
<tr>
<td>Notification </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_notification.html#ada019bff8ec25198a8e074910d728f5f">Description</a> </td></tr>
<tr>
<td>OfflineRecord </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_offline_record.html#aaa34e7e1b54b99d14772b2de44b9068b">Title</a> </td></tr>
<tr>
<td>Record </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#aedd23b6d4e900d1747e90f571ebbc52b">Number</a> </td></tr>
<tr>
<td>RecordAction </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record_action.html#ad3c1ecbb8aa44e7fa9971c1b3c26dcc7">ActionName</a> </td></tr>
<tr>
<td>Request </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_request.html#a87b6117af22685f9b8fa18055b2c6c82">Record</a> </td></tr>
<tr>
<td>SavedSearch </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_saved_search.html#afdc9a3663e55b73b8e15acf213baad53">FullName</a> </td></tr>
<tr>
<td>ScheduledTask </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_scheduled_task.html#aef3b5794fb854e03b0ef395ba6aa9796">Description</a> </td></tr>
<tr>
<td>SharePointItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_share_point_item.html#a2e4782b1dd2521450399118eaf73fff3">UniqueId</a> </td></tr>
<tr>
<td>Space </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_space.html#ab82e1903b2307f6fe10a9ddc6b5e0690">Number</a> </td></tr>
<tr>
<td>TodoItem </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_todo_item.html#a45e1508e2fb666e3f43792458013c0b2">Description</a> </td></tr>
<tr>
<td>UserLabel </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_user_label.html#a052b32713bda9d2ad158195c57933007">FullName</a> </td></tr>
<tr>
<td>ZipCode </td><td><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_zip_code.html#a0716094961cf37f3deee096ef2f32a2d">Postcode</a> </td></tr>
</table>
<p>Even with this information there are still things to be aware of, for example:</p><ul>
<li>LocationSortName is not necessarily unique, if you use it in a Location constructor and there is more than one match an exception will be thrown.</li>
<li>While ClassificationTitle is the name property for Classification ClassificationTitle will also work.</li>
</ul>
<h2><a class="anchor" id="fetch_by_database"></a>
Database find methods</h2>
<p>There are a number of methods available on the Database object. They key difference between these and the object constructors is that these return null if the object cannot be found where the object constructors throw an exception. These methods are:</p><ul>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#add247d23b2bcb83eb02a580105a187ee">FindTrimObjectByName</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#a547bd743a93681a82ec03ffc28a59740">FindTrimObjectByUri</a></li>
<li><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_database.html#ad2c31953fca197892b840e4429afadc8">FindTrimObjectByURN</a></li>
</ul>
<h3>Code samples</h3>
<div class="fragment"><div class="line"><span class="comment">// fetch by Record Number</span></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record1 = database.FindTrimObjectByName(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, <span class="stringliteral">&quot;REC_1&quot;</span>) as <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div><div class="line">Console.WriteLine(record1.Title);</div><div class="line"></div><div class="line"><span class="comment">// Fetch by Uri</span></div><div class="line">Record record2 = database.FindTrimObjectByUri(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Record, 9000000001) as Record;</div><div class="line">Console.WriteLine(record2.Title);</div><div class="line"></div><div class="line"><span class="comment">// Fetch by URN</span></div><div class="line">Record record3 = database.FindTrimObjectByURN(<span class="stringliteral">&quot;trim:I1/rec/9000000001&quot;</span>) as Record;</div><div class="line">Console.WriteLine(record3.Title);</div></div><!-- fragment --> <blockquote class="doxtable">
<p><b>Note:</b> The URN property is typically used when you need to persist a database and object type independent identifier for the object. </p>
</blockquote>
<h2><a class="anchor" id="fetch_by_search"></a>
TrimMainObjectSearch</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a> may be used in place of the constructor and Database methods of fetching a document. One benefit when fetching by name, where the name may not be unique, is that you can respond better to the various scenarios.</p>
<h3>Code sample</h3>
<div class="fragment"><div class="line"><span class="comment">// Find all Locations where the name starts with David</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectByPrefix(<span class="stringliteral">&quot;david&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Find the Locations with the Uri 1</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectByUris(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { 1 });</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Find all Locations who are direct members of the group &#39;Adelaide&#39;</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SelectThoseWithin(<span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ace5bf551379459c1c61d2a204061c455">Location</a>(database, <span class="stringliteral">&quot;Adelaide&quot;</span>));</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Find all Locations where the sort name is david</span></div><div class="line"><span class="comment">// You may want to return an error if there is more than one result, if you are looking for a unique Location</span></div><div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location);</div><div class="line">locationSearch.SetSearchString(<span class="stringliteral">&quot;locSortName:david&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(location.FullFormattedName);</div><div class="line">}</div></div><!-- fragment --> <hr/>
<h1><a class="anchor" id="fetchDoc"></a>
Document access alternatives</h1>
<h2><a class="anchor" id="doc_access_overview"></a>
Overview</h2>
<p>There are a variety of ways to retrieve an electronic document attached to a Record (or other object type), these are:</p><ul>
<li><a href="#getDoc">Record.GetDocument()</a></li>
<li><a href="#wgsCache">DocumentPathInClientCache</a></li>
<li><a href="#clientCache">DocumentPathInWGSCache</a></li>
<li><a href="#docStream">DocumentStream</a></li>
<li><a href="#downloadNotifier">DownloadNotifier</a></li>
</ul>
<h2><a class="anchor" id="getDoc"></a>
Record.GetDocument</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#ab24704f0123e0bebbc9410695aa8bf54">Record.GetDocument</a> is the primary way to get an electronic document from a Record and will be used for most .Net SDK applications. It allows the user to fetch a copy of the document from the document store to their local hard drive. If the document is already in the user's cache then it will be retrieved from their rather than from the store.</p>
<h3>Checkout without getting the document</h3>
<p>You may wish to set the Record edit status to checked out without fetching the Record, in this case simply call GetDocument with a null outputDocumentName. For example: </p><div class="fragment"><div class="line">Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">record.GetDocument(null, <span class="keyword">true</span>, null, null);</div></div><!-- fragment --> <h2><a class="anchor" id="clientCache"></a>
DocumentPathInClientCache</h2>
<p>This method of fetching documents was added to better support web services. The advantage it has over <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_record.html#ab24704f0123e0bebbc9410695aa8bf54">Record.GetDocument</a> is that it does not require you to store a new copy of the document, copying it from your local cache to the path in the outputDocumentName parameter. If document store caching is disabled this property will be empty, unless your application is running as a service or web service.</p>
<h3>Example</h3>
<div class="fragment"><div class="line">TrimApplication.SetAsWebService(<span class="stringliteral">&quot;c:\\hptrim\\mytest&quot;</span>);</div><div class="line"></div><div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a> database = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212ae307db07b3975fef922a80d07455ee5e">Database</a>())</div><div class="line">{</div><div class="line">    database.Id = <span class="stringliteral">&quot;I1&quot;</span>;</div><div class="line">    database.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div><div class="line">    database.TrustedUser = <span class="stringliteral">&quot;itu_tenduser&quot;</span>;</div><div class="line">    database.Connect();</div><div class="line"></div><div class="line">    Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (!record.IsDocumentInClientCache)</div><div class="line">    {</div><div class="line">        record.LoadDocumentIntoClientCache();</div><div class="line">    }</div><div class="line">    Console.WriteLine(record.DocumentPathInClientCache);</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="wgsCache"></a>
DocumentPathInWGSCache</h2>
<p>If your workgroup server has document caching enabled an application running on that server (not on a client machines) can use this property to get the Location of the document in the workgroup cache. The benefit of this is that the workgroup server cache can be pre-emptively loaded so the document can be in the cache before event the first time you ask for it.</p>
<h3>Example</h3>
<div class="fragment"><div class="line">Record record = <span class="keyword">new</span> Record(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div><div class="line">Console.WriteLine(record.DocumentPathInWGSCache);</div></div><!-- fragment --><h2><a class="anchor" id="downloadNotifier"></a>
DownloadNotifier</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_download_notifier.html">DownloadNotifier</a> is a simpler more flexible replacement for DocumentStream. A key benefit is that it is available to all document/file downloads, not only Record document. Like TrimDocumentStream the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_download_notifier.html">DownloadNotifier</a> has two advantages over other document access methods:</p><ol type="1">
<li>it starts returning bytes almost immediately, rather than you having to wait until the entire file has been copied from the document store, and</li>
<li>you may start part way through a file.</li>
</ol>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_download_notifier.html">DownloadNotifier</a> is of particular use in web applications where you will want to start returning the file to the end user as soon as possible rather than waiting until the entire file has been fetched from the document store, and also where you may wish to have a resumable download.</p>
<h3>Example</h3>
<div class="fragment"><div class="line"><span class="keywordtype">long</span> count = 20922;</div><div class="line">byte[] buffer = <span class="keyword">new</span> byte[20922];</div><div class="line">Record record = <span class="keyword">new</span> Record(db, <span class="stringliteral">&quot;REC_43&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordtype">long</span> bytesSoFar = 0; <span class="comment">// use bytesSoFar to start part way through the file for a partial download</span></div><div class="line"></div><div class="line"><span class="keyword">using</span> (DownloadNotifier notifier = <span class="keyword">new</span> DownloadNotifier(db, count, bytesSoFar))</div><div class="line">{</div><div class="line">    notifier.OnChunkAvailable += (byte[] chunk, <span class="keywordtype">long</span> chunkPos, <span class="keywordtype">long</span> chunkLen, <span class="keywordtype">bool</span> lastChunk) =&gt;</div><div class="line">    {</div><div class="line">        <span class="comment">// Write the chunk to an output stream here.</span></div><div class="line">    };</div><div class="line"></div><div class="line">    <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a40cdf0894e6033c131f440504d31f264aeaaefa2eb0b058d0642a985316176535">ExtractDocument</a> extractDoc = record.GetExtractDocument();</div><div class="line">    extractDoc.DoExtract(null, <span class="keyword">true</span>, <span class="keyword">false</span>, null);</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="dowload_other_object_types"></a>
Other object types</h2>
<p>While this document has focused primarily on Records other <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">main</a> and <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">child</a> objects also implement <a class="el" href="interface_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html">ITrimDocument</a> and therefore also support electronic documents. These objects will at least support the <a class="el" href="interface_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html#ade1af1673bd81cce446c99e13787db5a">Client Cache</a> method of getting the document and may also implement a method returning an <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_extract_document.html">ExtactDocument</a> (such as <a href="HP.HPTRIM.SDK.LocationEAddress.GetExtractDocument">LocationEAddress</a> )</p>
<h1><a class="anchor" id="localisedStrings"></a>
Localised strings</h1>
<p>When building a user interface base on the Content Manager SDK it can be helpful to use the captioned and localised strings provided by Content Manager, rather. Most strings used by Content Manager are available from the SDK in a way that will account for the user's language choice and changes to captions.</p>
<h2><a class="anchor" id="trimMEssages"></a>
TrimMessages</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_application_base.html#a141955bb5f06f255604735918443ced6">TrimApplication.GetMessage()</a> is used to fetch error and other messages from Content Manager. These messages will automatically account for any custom captions.</p>
<h3>Code Sample</h3>
<div class="fragment"><div class="line"><span class="comment">//This code will display the following string, replacing the word &#39;record&#39; with the custom caption for &#39;record&#39; if set.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// This record has  alternate contents. You can use the Show Alternate Contents button if you wish to load these relationships.</span></div><div class="line"></div><div class="line"><span class="keywordtype">string</span> message = TrimApplication.GetMessage(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a9de967b2ebe579684d69bd0e5853b7cc">MessageIds</a>.bob_recHasAltContentsMsg);</div><div class="line">Console.WriteLine(message);</div></div><!-- fragment --><h2><a class="anchor" id="objectCaptions"></a>
Captions</h2>
<p>Many custom strings can be fetch from an objects Caption property. This is particularly important when captions have been customised.</p>
<h3><a class="anchor" id="enumCaptions"></a>
Enum captions</h3>
<p>This code displays the caption (and plural caption) of the DisposalType enum followed by the captions for each <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_enum_item.html">EnumItem</a>.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p.html">HP</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m.html">HPTRIM</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_enum.html">Enum</a> myEnum = <span class="keyword">new</span> <a class="code" href="namespace_h_p.html">HP</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m.html">HPTRIM</a>.<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_enum.html">Enum</a>(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#af90c47dbff13aa2ea62d189f4445896b">AllEnumerations</a>.DisposalType, database);</div><div class="line"></div><div class="line">Console.WriteLine(myEnum.Caption);</div><div class="line">Console.WriteLine(myEnum.CaptionPlural);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (EnumItem enumItem <span class="keywordflow">in</span> myEnum.GetItemArray(null, <span class="keyword">true</span>))</div><div class="line">{</div><div class="line">    Console.WriteLine(enumItem.Caption);</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="propertyCaptions"></a>
Property Captions</h3>
<p>The <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_property_def.html">PropertyDef</a> class supplies captions for object properties, use the code below to get all writable property captions for the Location object. Other static methods to get PropertyDefs by object are:</p><ul>
<li>PropertyDef.GetAllProperties()</li>
<li>PropertyDef.GetDataGridProperties()</li>
<li>PropertyDef.GetViewPaneProperties()</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordflow">foreach</span> (PropertyDef propertyDef <span class="keywordflow">in</span> PropertyDef.GetWriteableProperties(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Location, database))</div><div class="line">{</div><div class="line">    Console.WriteLine(propertyDef.Caption);</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="searchClauseCaptions"></a>
Search Clause Captions</h3>
<p>Search clause captions work similarly to property definitions except that you must get a list of SearchClause Ids and then construct a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_search_clause_def.html">SearchClauseDef</a> from the Id. The sample below writes the captions for all Activity search clauses.</p>
<div class="fragment"><div class="line"><span class="keywordflow">foreach</span> (SearchClauseIds clauseId <span class="keywordflow">in</span> SearchClauseDef.GetAllSearchClauseIds(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Activity, database))</div><div class="line">{</div><div class="line">    SearchClauseDef clauseDef = <span class="keyword">new</span> SearchClauseDef(clauseId, database);</div><div class="line"></div><div class="line">    Console.WriteLine(clauseDef.Caption);</div><div class="line">}</div></div><!-- fragment --> <h3><a class="anchor" id="menuItemCaptions"></a>
Menu items</h3>
<p>Menus in Content Manager are a subject to themselves. Once again a definition object, <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_command_def.html">CommandDef</a>, provides metadata such as the menu or status bar string for each menu item.</p>
<div class="fragment"><div class="line">MenuPopup menuPopup = MenuPopup.GetMenuForTrimObject(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Classification);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (var menuItem <span class="keywordflow">in</span> menuPopup)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (menuItem is CommandDef)</div><div class="line">    {</div><div class="line">        CommandDef cdef = menuItem as CommandDef;</div><div class="line">        Console.WriteLine(cdef.GetMenuEntryString(<a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.Classification));</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="formDefinitionCaptions"></a>
FormDefinition</h2>
<p><a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_form_definition.html">FormDefiniton</a> is particularly useful for Records where it is possible to set custom captions on the various properties on the Record entry form. As with the other definition objects FormDefnition (and its related classes) are useful for much more than captios, in fact they are the foundation from which the Web Client forms are built.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> recordType = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(database, <span class="stringliteral">&quot;Document&quot;</span>);</div><div class="line">FormDefinition formDefinition = recordType.RecordPropertiesFormDefinition;</div><div class="line"></div><div class="line"><span class="keywordflow">for</span> (uint pageCount = 0; pageCount &lt; formDefinition.PageCount; pageCount++)</div><div class="line">{</div><div class="line">    PageDefinition pageDefinition = formDefinition.GetPage(pageCount);</div><div class="line"></div><div class="line">    Console.WriteLine(pageDefinition.Caption);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (uint itemCount = 0; itemCount &lt; pageDefinition.ItemCount; itemCount++ )</div><div class="line">    {</div><div class="line">        PageItemDefinition itemDefinition = pageDefinition.GetItem(itemCount);</div><div class="line">        Console.WriteLine(itemDefinition.Caption);</div><div class="line"></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="lookupset_Items"></a>
Fetching LookupSet Items</h1>
<p>In 82 <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_lookup_set.html">LookupSet</a> Items were freed from the restrictions of being of type <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">TrimChildObject</a>. This means that a lookup set item is now a <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>, at the same level as the lookup set itself. Why was this done? Mainly to allow for large lookup sets. The parent child relationship among RM objects has practical limits on the number of children a main object can have.</p>
<h2><a class="anchor" id="new_lookupitem"></a>
Example: Adding a new LookupItem</h2>
<p>To add a new <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_lookup_item.html">LookupItem</a> instantiate it using the <a class="el" href="class_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k_1_1_lookup_set.html">LookupSet</a> as the constructor paramater.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a91dba629c9e6f4039af8cebac763478d">LookupSet</a> lookupSet = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a91dba629c9e6f4039af8cebac763478d">LookupSet</a>(database, 9000000000);</div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a8f19a58561f3fda03f457894923c5c49">LookupItem</a> lookupItem = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212a8f19a58561f3fda03f457894923c5c49">LookupItem</a>(lookupSet);</div><div class="line"></div><div class="line">lookupItem.Name = <span class="stringliteral">&quot;My Test&quot;</span>;</div><div class="line">lookupItem.Save();</div></div><!-- fragment --><h2><a class="anchor" id="fetching_lookup_items"></a>
Example: Fetching lookup items</h2>
<p>You can get a list of lookup items just as you would any other main object type (e.g. record or location), using the TrimMainObjectSearch, as seen here.</p>
<div class="fragment"><div class="line">TrimMainObjectSearch lookupItemSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#a0dc503af5a604d44f6c97f781fcc4212">BaseObjectTypes</a>.LookupItem);</div><div class="line">lookupItemSearch.SetSearchString(<span class="stringliteral">&quot;set:9000000000&quot;</span>);</div><div class="line"></div><div class="line"><span class="keywordflow">foreach</span> (LookupItem item <span class="keywordflow">in</span> lookupItemSearch)</div><div class="line">{</div><div class="line">    Console.WriteLine(item.Name);</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="create_record_manual_number"></a>
Create a Record using manual numbering</h1>
<p>When a Record Type has a Record Number containing both manual and automatic portions then user interaction is required to create the Record. This can be done in the SDK by first suggesting a number (to get the auto-generated portion) and then replacing the manual portion with whatever the user says. </p><div class="image">
<img src="record_manual_number.PNG"  alt="Record Number"/>
</div>
<h2><a class="anchor" id="example_manual_record_number"></a>
Example: Manual Record Number</h2>
<div class="fragment"><div class="line"><span class="keywordtype">string</span> manualPortion = <span class="stringliteral">&quot;TRY-THIS&quot;</span>;</div><div class="line"></div><div class="line"><a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> rt = <span class="keyword">new</span> <a class="code" href="namespace_h_p_1_1_h_p_t_r_i_m_1_1_s_d_k.html#adaa2e9deefea9f244a9d8eb36a2ad422a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(database, <span class="stringliteral">&quot;RECORD TYPE NAME&quot;</span>);</div><div class="line"></div><div class="line">Record rec = <span class="keyword">new</span> Record(rt);</div><div class="line"></div><div class="line">rec.Title = <span class="stringliteral">&quot;test&quot;</span>;</div><div class="line"><span class="keywordtype">string</span> suggestedNumber = rec.GetSuggestedNumber(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">suggestedNumber = suggestedNumber.Replace(<span class="stringliteral">&quot;zzz-aaaa&quot;</span>, manualPortion);</div><div class="line">rec.LongNumber = suggestedNumber;</div><div class="line"></div><div class="line">rec.Save();</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
